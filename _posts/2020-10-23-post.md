---
title: "서버 이관을 해보자 - 2. apahce + multi tomcat (아파치에 여러 톰캣 연동)"
date: 2020-10-23 1254:31:00 -0400
categories: mysql cetnos apache
classes: wide
---

## 1. 톰캣에 소스 추가

파일질라를 통해서 프로젝트 war로 export해서 붙여넣었다. 톰캣 폴더 밑에 webapps 폴더 안에 넣어준다.

tomcat9/conf/server.xml 파일도 수정해주어야한다. 

```xml
<!-- 제일 하단에 이부분을 넣어준다. 밑에와 같이 넣어주면 주소에 ip만 쳐도 메인화면이 뜬다. -->
<Context docBase="프로젝트명" path="/" reloadable="true" source="org.eclipse.jst.jee.server:프로젝트명"/></Host>
```

그러고 톰캣을 실행했는데 에러가 난다. 분명 내 로컬에선 잘 돌아가는데 왜 신규 서버에선 안돌아가는것인가.. 이전에 다른 프로젝트 햇던거 참고해서 log4j 관련 부분을 pom.xml에서 수정해주었더니 잘 되었다.
(구글링하면 잘 나온다.)

로그 보면서 path가 안맞는다고 떠기도 하고 에러 뜨는거 고치고나서 서버 올리니까 제대로 메인화면이 뜬다! (서버를 내렸다 올릴때 천천히 시간을 가지고해야 제대로 반영이 되는듯하다.)

## 2. 다중 톰캣 각각 기동 되는지 확인

아파치 하나에 여러개의 톰캣이 돌아가야한다. 한톰캣에 여러개의 프로젝트를 넣으면 만약 서버 재기동시 여러 프로젝트가 동시에 안되기 때문이다.

톰캣 포트번호만 다 다르게 하면되지 않을까 하는 생각으로 진행해본다.

일단 기존 톰캣은 잘 돌아가는거 확인했으니 톰캣서버를 끄고 톰캣폴더 복붙 여러개 한다. (나는 3개 + 원본 1개)

기존 톰캣은 일단 원본으로 그냥 냅뒀다.

그래서 tomcat9_1, tomcat9_2, tomcat9_3 이렇게 폴더 3개를 복붙했다.

여기서 이제 첫번째로 할 것은 각각의 톰캣이 잘 돌아가는지 각각 확이하는 작업을 할 것이다. 이때 포트번호를 다 다르게 해서 진행할것이다.

각 톰캣폴더의 conf 폴더밑에 server.xml파일의 포트를 다 고쳐줘야한다고한다.

기본적으로 8005, 8009, 8080 3개가 있는데 각각 1씩 늘려주었다. (8443 포트 그대로 쓴다. )

그리고 httpd.conf, workers.properties 파일을 수정해주어야한다. 이것은 아파치 폴더안에 conf 폴더 밑에 있다.

각각 버전마다 다 달라서 참고만 할수있게 주석을 제외한 전체를 올린다.




